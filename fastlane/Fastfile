ENV["FASTLANE_XCODEBUILD_SETTINGS_TIMEOUT"] = "600"

default_platform(:ios)

platform :ios do
  desc "Deploy a new version for internal testing"
  lane :dev_ios do
    scan(
      device: ENV['SIMULATOR_ID']
    )
    app_store_connect_api_key(
      key_id: ENV["APP_STORE_CONNECT_API_KEY_KEY_ID"],
      issuer_id: ENV["APP_STORE_CONNECT_API_KEY_ISSUER_ID"],
      key_content: ENV["APP_STORE_CONNECT_API_KEY_KEY"],
      in_house: false  # set to true if you're part of the Apple Enterprise Program
    )
    match(
      type: "appstore",
      platform: "ios",
      readonly: true
    )
    gym(
      scheme: "Cornerstones"
    )
    pilot(
      skip_waiting_for_build_processing: true,
      skip_submission: true
    )
    increment_build_number
  end
end
